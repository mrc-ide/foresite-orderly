---
format: 
  html:
    toc: true
    toc-location: left
    embed-resources: true
editor: source
params:
  iso3c: "NULL"
  country: "NULL"
  version: "NULL"
---

```{css, echo = FALSE}
.output {
max-height: 500px;
overflow-y: auto;
}
```

```{r}
#| echo: false
#| warning: false
plots <- readRDS("diagnostic_plots.RDS")
library(patchwork)
title <- paste0(params$country, " (", params$iso3c, "). ", "Version: ", params$version)
```

---
title: "`r title`"
title-block-banner: true
---

## Subnational units

```{r,echo=FALSE}
fheight_units = length(plots$geom_graphic_areas$layers[[1]]$data$name) * 1.5
```

```{r, fig.height=fheight_units}
#| class: output
#| echo: false
plots$geom_graphic_areas
```

## World malaria report burden estimates

::: panel-tabset
## Clinical incidence

```{r}
#| echo: false
plots$incidence
```

## Cases

```{r}
#| echo: false
plots$cases
```

## Mortality Rate

```{r}
#| echo: false
plots$mortality
```

## Deaths

```{r}
#| echo: false
plots$deaths
```
:::

## Malaria Atlas Project prevalence summaries

### Prevalance timeseries

```{r}
#| echo: false
#| warning: false
plots$country_prevalence
```

### Prevlance maps

```{r,echo=FALSE}
fheight_prev = length(unique(plots$pfpr_map$data$year)) * 2
```

```{r, fig.height=fheight_prev}
#| class: output
#| echo: false
(plots$pfpr_map | plots$pvpr_map)
```

## Population and Demography

### Population timeseries

::: panel-tabset
## Population

```{r}
#| echo: false
plots$country_population
```

## Population at risk

```{r}
#| echo: false
plots$country_par
```

## Urban/Rural population

```{r}
#| echo: false
plots$country_urban_rural
```

## Proportion Urban

```{r}
#| echo: false
plots$country_prop_urban
```

:::

### Urban/Rural subnational population
```{r,echo=FALSE}
fheight_urban = length(unique(plots$area_urban_rural$data$name)) * 1
```

```{r, fig.height=fheight_urban}
#| class: output
#| echo: false
plots$area_urban_rural
```

### Age-distribution

```{r,echo=FALSE}
fheight_age = length(unique(plots$age_dist$data$year)) * 1
```

```{r, fig.height=fheight_age}
#| class: output
#| echo: false
plots$age_dist
```

## Seasonality
```{r,echo=FALSE}
fheight_seasonality = length(unique(plots$rainfall$data$name)) * 2
```

```{r, fig.height=fheight_seasonality}
#| class: output
#| echo: false
plots$rainfall | plots$seasonality
```

## Mosquito vectors

### Species
```{r,echo=FALSE}
fheight_vectors = length(unique(plots$vectors$data$name)) * 0.25
```

```{r, fig.height=fheight_vectors}
#| class: output
#| echo: false
plots$vectors
```

### Pyrethroid resistance
```{r}
#| echo: false
plots$resistance
```

## Blood disorders

::: panel-tabset
## GDP6

```{r}
#| echo: false
plots$gdp6
```

## Sicklecell

```{r}
#| echo: false
plots$sickle
```

## Duffy negativity

```{r}
#| echo: false
plots$duffy
```

## HPC

```{r}
#| echo: false
plots$hpc
```

:::

## Accessibility

::: panel-tabset
## Motor transport

```{r}
#| echo: false
plots$motor
```

## Walking

```{r}
#| echo: false
plots$walk
```

## To city

```{r}
#| echo: false
plots$city
```


:::