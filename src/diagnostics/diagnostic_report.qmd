---
format: 
  html:
    toc: true
    toc-location: left
    embed-resources: true
editor: source
params:
  iso3c: "NULL"
  country: "NULL"
  version: "NULL"
---

```{css, echo = FALSE}
.output {
max-height: 500px;
overflow-y: auto;
}
```

```{r}
#| echo: false
#| warning: false
plots <- readRDS("diagnostic_plots.RDS")
library(patchwork)
title <- paste0(params$country, " (", params$iso3c, "). ", "Version: ", params$version)
```

---
title: "`r title`"
title-block-banner: true
---

## World malaria report burden estimates

::: panel-tabset
## Clinical incidence

```{r}
#| echo: false
plots$incidence
```

## Cases

```{r}
#| echo: false
plots$cases
```

## Mortality Rate

```{r}
#| echo: false
plots$mortality
```

## Deaths

```{r}
#| echo: false
plots$deaths
```
:::

## Malaria Atlas Project prevalence summaries

::: panel-tabset
## Prevalence

```{r}
#| echo: false
plots$country_prevalence
```

## PfPr Map

```{r}
#| echo: false
plots$pfpr_map
```

## PvPr Map

```{r}
#| echo: false
plots$pvpr_map
```
:::

## Population estimates

::: panel-tabset
## Population

```{r}
#| echo: false
plots$country_population
```

## Population at risk

```{r}
#| echo: false
plots$country_par
```

## Urban/Rural population

```{r}
#| echo: false
plots$country_urban_rural
```

## Proportion Urban

```{r}
#| echo: false
plots$country_prop_urban
```

:::

### Urban/Rural subnational population
```{r,echo=FALSE}
fheight_urban = length(plots$area_urban_rural$facet$params$facets) * 50
```

```{r, fig.height=fheight_urban}
#| class: output
#| echo: false
plots$area_urban_rural
```

## Age-distribution

```{r,echo=FALSE}
fheight_age = length(plots$age_dist$facet$params$facets) * 50
```

```{r, fig.height=fheight_age}
#| class: output
#| echo: false
plots$age_dist
```

## Seasonality
```{r,echo=FALSE}
fheight_seasonality = length(plots$rainfall$facet$params$facets) * 50
```

```{r, fig.height=fheight_seasonality}
#| class: output
#| echo: false
plots$rainfall | plots$seasonality
```